(function(){!function(t){"use strict";return t(function(){var n,e,a,o,i,r,l,u,s;return o=t("#form-search"),l=o.find("[name=q]"),i=o.find("[name=location]"),e=o.find(".force-selection"),r=t("#location-dropdown-wrapper"),l.length>0&&VARAA.initTypeahead(l,"services"),l.bind("typeahead:selected",function(t,n){return o.data("disableSubmission",!1),"category"===n.type?(o.data("suggestion",l.val()),o.data("old-action",o.attr("action")),o.attr("action",n.url)):"undefined"!=typeof n.url?window.location=n.url:void 0}),s=function(n){return t(n.target).tooltip("hide")},l.on("focus",s).on("blur",function(){var n,a,i;return n=t(this),i=n.val(),a=l.data("bloodhound"),a.get(i,function(t){return t=t.filter(function(t){return t.name===i}),0===t.length?(e.show(),o.data("disableSubmission",!0)):(e.hide(),o.data("disableSubmission",!1))})}),i.on("focus",function(t){return s(t),r.addClass("open"),this.value=""}),o.on("submit",function(t){var n,e,a;return o.data("disableSubmission")===!0?void t.preventDefault():o.data("bypass")===!0?!0:o.data("old-action")?(l.val()!==o.data("suggestion")&&o.attr("action",o.data("old-action")),!0):(t.preventDefault(),n=function(){return o.data("bypass",!0),o.submit()},a=0===l.val().length,e=0===i.val().length,a&&l.tooltip("show"),e&&i.tooltip("show"),e||a?void 0:i.data(!1)?VARAA.getLocation().then(function(t,n){return o.find("[name=lat]").val(t),o.find("[name=lng]").val(n)}).always(n):n())}),t("a.form-search-city").on("click",function(n){var e;return n.preventDefault(),e=t(this),o.find("[name=type]").val(e.data("type")),i.attr("data-current-location",e.data("current-location")),i.val(e.text()),r.removeClass("open")}),a=t("#form-contact"),a.length>0&&a.on("submit",function(n){var e,a,o,i;return n.preventDefault(),a=t(this),i=a.find(".alert-success"),e=a.find(".alert-danger"),o=a.find("[type=submit]"),t.ajax({url:a.attr("action"),method:"POST",dataType:"JSON",data:a.serialize()}).then(function(){return e.hide(),i.show(),o.attr("disabled",!0)}).fail(function(n){var a,o,i,r;if(a=n.responseJSON,422===n.status){e.empty(),r=function(n){return e.append(t("<p/>").html(n.join("<br>")))};for(i in a)o=a[i],r(o)}else e.html(a.message);return e.show()})}),t("#js-navbar").find("a").on("click",function(n){var e,a,o,i,r,l;return n.preventDefault(),e=t(this),a=t("body"),i=a.data("lat"),r=a.data("lng"),null!=i&&null!=r&&""!==i&&""!==r?window.location=e.prop("href"):(l=function(n){return i=n.coords.latitude,r=n.coords.longitude,t.ajax({url:a.data("geo-url"),type:"POST",data:{lat:i,lng:r}}).done(function(){return window.location=e.prop("href")})},o=function(){return window.location=e.prop("href")},navigator.geolocation.getCurrentPosition(l,o,{timeout:1e4}))}),t(".datetime-link").on("click",function(t){return t.preventDefault()}).on("focus",function(n){return n.preventDefault(),t(this).siblings(".datetime-control").show()}).on("blur",function(n){return n.preventDefault(),t(this).siblings(".datetime-control").hide()}),t("#js-choose-category").on("click",function(n){return n.preventDefault(),t.scrollTo("#js-home-categories",{duration:1e3})}),u=function(n,e){var a,o,i,r;return a=n.find("li:not(.toggle):lt("+e+")"),i=n.find("li:not(.toggle):gt("+(e-1)+")"),r=n.find(".toggle"),o=n.find(".more"),a.show(),i.length>0&&o.show(),r.on("click",function(n){var e;return n.preventDefault(),e=t(this),i.slideToggle(),e.hide(),e.siblings(".toggle").show()})},t("ul.list-categories").each(function(n,e){return u(t(e),3)}),u(t("#js-category-filter"),6),n=t(".js-deal"),t("a.js-filter-link").on("click",function(e){var a,o;return e.preventDefault(),o=t(this),o.toggleClass("active"),a=t("a.js-filter-link.active"),a.length?(n.hide(),a.each(function(n,e){var a,o,i;return a=t(e),i=a.data("id"),o=t(".js-deal-category-"+i),o.fadeIn()})):n.show()})})}(jQuery)}).call(this);