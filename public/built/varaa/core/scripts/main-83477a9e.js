(function(){$(function(){"use strict";var t,e,n,a,o,r,i,l,c,u;return e=$(document),l=$("#js-queryInput"),i=$("#js-locationInput"),c=function(t,e){var n;return n=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name"),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,prefetch:{url:"/search/"+e+".json",filter:function(t){return"string"==typeof t[0]?$.map(t,function(t){return{name:t}}):t}}}),n.clearPrefetchCache(),n.initialize(),t.typeahead({highlight:!0,hint:!0},{name:e,displayKey:"name",source:n.ttAdapter()})},null!=l&&null!=i&&l.length>0&&i.length>0&&(c(l,"services"),c(i,"locations")),n=$("#main-search-form"),n.length&&(o=n.find("[name=lat]"),r=n.find("[name=lng]"),u=!(o.val().length>0&&r.val().length>0),l.on("focus",function(){var t,e,a;if(navigator.geolocation&&u)return t=$("#js-geolocation-info"),u&&t.show(),a=function(t){var e,a;return e=t.coords.latitude,a=t.coords.longitude,o.val(e),r.val(a),$.ajax({url:n.data("update-location-url"),type:"POST",data:{lat:e,lng:a}})},e=function(t){return console.log(t)},navigator.geolocation.getCurrentPosition(a,e,{timeout:1e4}),u=!1})),a=$("#js-languageSwitcher"),a.change(function(){return window.location=this.value}),t=$("#header-cart"),t.popover({placement:"bottom",trigger:"click",html:!0}),e.on("click",function(e){var n;n=$(e.target),"popover"!==n.data("toggle")&&0===n.parents("#header-cart").length&&0===n.parents(".popover.in").length&&t.popover("hide")}),e.on("cart.reload",function(n,a){return $.ajax({url:t.data("cart-url"),dataType:"JSON"}).done(function(n){return t.find(".content").html(n.totalItems),t.attr("data-content",n.content),a?(t.popover("show"),e.scrollTop(0)):void 0})}),e.on("click","a.js-btn-cart-remove",function(t){var n;return t.preventDefault(),n=$(this),n.find("i.fa").removeClass("fa-close").addClass("fa-spinner fa-spin"),$.ajax({url:n.attr("href")}).done(function(){return $("tr.cart-detail-"+n.data("detail-id")).fadeOut(),e.trigger("cart.reload",!0)})}),e.trigger("cart.reload",!1)})}).call(this);